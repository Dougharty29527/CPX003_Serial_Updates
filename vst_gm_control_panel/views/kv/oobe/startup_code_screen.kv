#:kivy 2.3.0

<StartupCodeScreen>
    md_bg_color: '#13202E'

    TopBar:

    MDBoxLayout:
        adaptive_size: True
        pos_hint: {'top': .975, 'center_x': .5}

        StatusBar:

    # Main content
    MDBoxLayout:
        adaptive_size: True
        orientation: 'vertical'
        pos_hint: {'center_x': .5, 'center_y': .39}
        spacing: dp(6)
        
        MDBoxLayout:
            adaptive_size: True
            orientation: 'vertical'
            spacing: dp(6)
            pos_hint: {'center_x': .5}
            
            # Title
            OOBETitleSecondaryLabel:
                id: startup_code_title
                text: app.language_handler.translate('startup_code_title', 'STARTUP CODE')

            # Description text
            MDBoxLayout:
                adaptive_size: True
                orientation: 'vertical'
                spacing: dp(2)
                pos_hint: {'center_x': .5}
                
                OOBEDescriptionLabel:
                    id: startup_code_description_line1
                    text: app.language_handler.translate('startup_code_description_line1', 'TO RECEIVE YOUR STARTUP CODE, COMPLETE THE APPENDIX B -')
                
                OOBEDescriptionLabel:
                    id: startup_code_description_line2
                    text: app.language_handler.translate('startup_code_description_line2', 'STARTUP CONTRACTOR CHECKOUT FORM ONLINE AT WWW.VSTHOSE.COM')

            # Input field
            MDBoxLayout:
                adaptive_height: True
                size_hint_x: 1
                height: dp(35)  # Add explicit height
                orientation: 'horizontal'
                pos_hint: {'center_x': .5}
                spacing: dp(4)
                padding: [0, dp(4), 0, 0]  # Reduced top padding
                
                MDTextField:
                    id: code_input
                    font_size: sp(18)  # Reduced font size
                    size_hint_x: .8
                    pos_hint: {'center_x': .5, 'center_y': .5}
                    halign: 'center'
                    password: False
                    mode: "outlined"  # Using outlined mode for more compact appearance
            
            # Spacer to push keypad down
            Widget:
                size_hint_y: .05
                
            # Keyboard Layout
            MDBoxLayout:
                orientation: 'vertical'
                adaptive_height: True
                spacing: dp(15)
                size_hint_x: .9
                pos_hint: {'center_x': .5}
            
                # Numbers Row
                KeypadBtnContainer:
                    KeypadBtn:
                        text: '1'
                        on_press: root.add_character('1')
                    KeypadBtn:
                        text: '2'
                        on_press: root.add_character('2')
                    KeypadBtn:
                        text: '3'
                        on_press: root.add_character('3')
                    KeypadBtn:
                        text: '4'
                        on_press: root.add_character('4')
                    KeypadBtn:
                        text: '5'
                        on_press: root.add_character('5')
                    KeypadBtn:
                        text: '6'
                        on_press: root.add_character('6')
                    KeypadBtn:
                        text: '7'
                        on_press: root.add_character('7')
                    KeypadBtn:
                        text: '8'
                        on_press: root.add_character('8')
                    KeypadBtn:
                        text: '9'
                        on_press: root.add_character('9')
                    KeypadBtn:
                        text: '0'
                        on_press: root.add_character('0')
                
                # Hex Letters Row (A-G) with backspace
                KeypadBtnContainer:
                    KeypadBtn:
                        text: 'A'
                        on_press: root.add_character('A')
                    KeypadBtn:
                        text: 'B'
                        on_press: root.add_character('B')
                    KeypadBtn:
                        text: 'C'
                        on_press: root.add_character('C')
                    KeypadBtn:
                        text: 'D'
                        on_press: root.add_character('D')
                    KeypadBtn:
                        text: 'E'
                        on_press: root.add_character('E')
                    KeypadBtn:
                        text: 'F'
                        on_press: root.add_character('F')
                    KeypadBtn:
                        text: 'G'
                        on_press: root.add_character('G')
                    KeypadPunctuationBtn:
                        text: '-'
                        on_press: root.add_character('-')
                    ActionKeyBtn:
                        icon: 'backspace'
                        size: '124dp', '49dp'  # Width of two buttons
                        text_color: app.theme_cls.tertiaryColor
                        on_press: root.delete_character()
            
            # Confirm button container
            MDBoxLayout:
                adaptive_size: True
                orientation: 'vertical'
                pos_hint: {'center_x': .5}
                padding: [0, dp(12), 0, dp(60)]
                
                # Confirm button
                DefaultBtn:
                    id: confirm_btn
                    text: app.language_handler.translate('confirm', 'CONFIRM')
                    width: dp(200)
                    md_bg_color: '#253849'
                    on_press: root.on_code_entered()
    
    # Back button
    MDBoxLayout:
        adaptive_size: True
        orientation: 'vertical'
        pos_hint: {'center_x': .5, 'center_y': .09}
        padding: [0, dp(27), 0, 0]

        BackBtn:
            on_press: root.go_back()

    StatIndicator: