#:kivy 2.3.0

<SystemConfigScreen>
    md_bg_color: app.theme_cls.onPrimaryColor

    MDNavigationLayout:

        MDScreenManager:

            MDScreen:

                TopBar:

                StatusBar:
                    pos_hint: {'top': .975, 'center_x': .5}

                MDBoxLayout:
                    adaptive_height: True
                    orientation: 'vertical'
                    pos_hint: {'center_x': .5, 'center_y': .59}

                    MDBoxLayout:
                        adaptive_size: True
                        orientation: 'vertical'
                        spacing: '32dp'
                        pos_hint: {'center_x': .5}

                        DefaultBtnContainer:
                            orientation: 'horizontal'
                            spacing: '32dp'

                            DefaultBtnContainer:
                                orientation: 'vertical'
                                spacing: '2dp'

                                DefaultBtn:
                                    id: low_limit
                                    text: 'LOW LIMIT'
                                    width: '185dp'
                                    on_press: root.open_keypad(keypad_sheet, 'low_limit')

                                InfoLabel:
                                    text: root.low_limit + ' iwc'
                                    pos_hint: {'center_x': .5, 'center_y': .5}

                            DefaultBtnContainer:
                                orientation: 'vertical'
                                spacing: '2dp'

                                DefaultBtn:
                                    id: high_limit
                                    text: 'HIGH LIMIT'
                                    width: '185dp'
                                    on_press: root.open_keypad(keypad_sheet, 'high_limit')

                                InfoLabel:
                                    text: root.high_limit + ' iwc'
                                    pos_hint: {'center_x': .5, 'center_y': .5}

                        DefaultBtnContainer:
                            orientation: 'horizontal'
                            spacing: '32dp'

                            DefaultBtnContainer:
                                orientation: 'vertical'
                                spacing: '2dp'

                                DefaultBtn:
                                    id: run_time
                                    text: 'RUN TIME'
                                    width: '185dp'
                                    on_press: root.open_keypad(keypad_sheet, 'run_time')

                                InfoLabel:
                                    text: root.run_time + ' sec'
                                    pos_hint: {'center_x': .5, 'center_y': .5}

                            DefaultBtnContainer:
                                orientation: 'vertical'
                                spacing: '2dp'

                                DefaultBtn:
                                    id: rest_time
                                    text: 'REST TIME'
                                    width: '185dp'
                                    on_press: root.open_keypad(keypad_sheet, 'rest_time')

                                InfoLabel:
                                    text: root.rest_time + ' sec'
                                    pos_hint: {'center_x': .5, 'center_y': .5}

                MDBoxLayout:
                    adaptive_size: True
                    orientation: 'horizontal'
                    pos_hint: {'center_x': .5, 'center_y': .27}
                    spacing: '24dp'

                    DefaultBtn:
                        id: start
                        text: 'START TEST'
                        width: '200dp'
                        disabled: True if app.test_mode or app.bleed else False
                        on_press: root.confirm_test_dialog() if not (app.test_mode or app.bleed) else ''

                    DefaultBtn:
                        id: stop
                        text: 'STOP TEST'
                        width: '200dp'
                        disabled: False if app.test_mode or app.bleed else True
                        on_press: root.stop_test() if app.test_mode or app.bleed else ''


                MDBoxLayout:  # Back Button
                    adaptive_size: True
                    orientation: 'vertical'
                    pos_hint: {'center_x': .5, 'y': .06}

                    BackBtn:
                        on_press: app.switch_screen('System')

                FullAccessIndicator:

                StatIndicator:

                VersionIndicator:

                SideBar:

        NoDragMDBottomSheet:
            id: keypad_sheet
            size_hint: None, None
            size: '525dp', '372dp'
            background_color: app.theme_cls.surfaceColor

            MDBottomSheetDragHandleButton:
                icon: 'close'
                on_release: keypad_sheet.set_state('toggle')
                pos_hint: {'top': 1, 'right': 1}

            MDScrollView:
                do_scroll_x: False
                do_scroll_y: False

                MDBoxLayout:
                    orientation: 'vertical'
                    adaptive_height: True

                    MDBoxLayout:
                        adaptive_height: True
                        size_hint_x: .7
                        orientation: 'vertical'
                        spacing: '12dp'
                        pos_hint: {'center_x': .5}

                        MDBoxLayout:
                            adaptive_width: True
                            size_hint_y: None
                            height: '75dp'
                            pos_hint: {'center_x': .5}
                            padding: [0, 0, 0, '28dp']

                            KeypadTextField:
                                id: input_field
                                text: ''

                        KeypadBtnContainer:
                            padding: [0, '12dp', 0, 0]

                            KeypadBtn:
                                text: '1'
                                on_press: root.add_digit(1)

                            KeypadBtn:
                                text: '2'
                                on_press: root.add_digit(2)

                            KeypadBtn:
                                text: '3'
                                on_press: root.add_digit(3)

                            KeypadBtn:
                                text: '4'
                                on_press: root.add_digit(4)

                            KeypadBtn:
                                text: '5'
                                on_press: root.add_digit(5)

                            KeypadPunctuationBtn:
                                text: '-'
                                on_press: root.add_digit('-')

                        KeypadBtnContainer:

                            KeypadBtn:
                                text: '6'
                                on_press: root.add_digit(6)

                            KeypadBtn:
                                text: '7'
                                on_press: root.add_digit(7)

                            KeypadBtn:
                                text: '8'
                                on_press: root.add_digit(8)

                            KeypadBtn:
                                text: '9'
                                on_press: root.add_digit(9)

                            KeypadBtn:
                                text: '0'
                                on_press: root.add_digit(0)

                            KeypadPunctuationBtn:
                                text: '.'
                                on_press: root.add_digit('.')

                        KeypadBtnContainer:

                            ActionKeyBtn:
                                icon: 'backspace'
                                text_color: app.theme_cls.tertiaryColor
                                on_press: root.backspace()

                            ActionKeyBtn:
                                icon: 'check-bold'
                                text_color: app.success_color
                                on_press:
                                    root.submit()
                                    keypad_sheet.set_state('toggle')
